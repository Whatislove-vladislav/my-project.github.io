<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>П'ятнашки 6x6: Квадратний виклик</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 10px;
      box-sizing: border-box;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 1.5rem;
      text-align: center;
    }
    #stats {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 400px;
      margin-bottom: 10px;
    }
    .stat-box {
      background: white;
      padding: 8px 12px;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #game {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 5px;
      width: 100%;
      max-width: 400px;
      margin: 0 auto;
    }
    .tile {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      border-radius: 3px;
      cursor: pointer;
      user-select: none;
      text-align: center;
      padding: 2px;
      transition: all 0.3s ease;
      min-width: 0;
      word-break: break-word;
    }
    .tile:active {
      transform: scale(0.95);
    }
    .good {
      background: #fff;
      color: #000;
      box-shadow: 0 2px 3px rgba(0,0,0,0.1);
    }
    .bad {
      background: #000;
      color: #fff;
      box-shadow: 0 2px 3px rgba(0,0,0,0.2);
    }
    .empty {
      background: transparent;
      border: 1px dashed #ccc;
      cursor: default;
    }
    #controls {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }
    button {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
      font-size: 14px;
    }
    #corner-info {
      margin-top: 15px;
      padding: 10px;
      background: #fff;
      border-radius: 6px;
      max-width: 400px;
      text-align: center;
    }
    @media (max-width: 450px) {
      .tile {
        font-size: 9px;
      }
      #game {
        gap: 3px;
        max-width: 340px;
      }
    }
  </style>
</head>
<body>

<h1>П'ятнашки 6×6: Квадратний виклик</h1>
<div id="stats">
  <div class="stat-box">Час: <span id="timer">0</span> сек</div>
  <div class="stat-box">Ходи: <span id="moves">0</span></div>
</div>
<div id="game"></div>
<div id="corner-info">
  Зберіть 4 чорні плитки у квадрат 2×2 у будь-якому кутку
</div>
<div id="controls">
  <button id="resetButton">Рестарт</button>
  <button id="newGameButton">Нова гра</button>
</div>

<script>
  // Початкові дані
  const goodTiles = [
    'Прогулятися', 'Поспілкуватися', 'Допомогти батькам', 'Спорт',
    'Книга', 'Молитва', 'Прибирання', 'Музика',
    'Планування', 'Сон', 'Уроки', 'Настільні ігри',
    'Хобі', 'Нове слово', 'Малювання', 'Зарядка',
    'Лист', 'Іноземна мова', 'Готування', 'Документальний фільм',
    'Медитація', 'Щоденник', 'Волонтерство', 'Навчання'
  ];
  
  const badTiles = ['Рілси', 'Тік Ток', 'Бравл Старс', 'Тролінг', 'Інстаграм'];
  const replacements = ['Досліджувати Біблію', 'Навчитись чомусь новому', 'Допомогти ближньому', 'Подзвонити рідним'];
  const gridSize = 6;
  
  let tiles = [];
  let timer;
  let seconds = 0;
  let moves = 0;
  let playerName = "Гравець";

  // Ініціалізація гри
  function initGame() {
    playerName = prompt("Введіть ваше ім'я:", "Гравець") || "Гравець";
    
    let allTiles = [...goodTiles, ...badTiles];
    
    // Додаємо плитки до 36 клітинок (6x6)
    while (allTiles.length < gridSize * gridSize - 4) { // -4 тому що 4 плитки будуть пустими
      const randomTile = Math.
        random() > 0.3 
        ? goodTiles[Math.floor(Math.random() * goodTiles.length)]
        : badTiles[Math.floor(Math.random() * badTiles.length)];
      allTiles.push(randomTile);
    }
    
    // Додаємо 4 пусті клітинки
    tiles = shuffle([...allTiles, '', '', '', '']);
    resetStats();
    render();
  }

  // Скидання статистики
  function resetStats() {
    clearInterval(timer);
    seconds = 0;
    moves = 0;
    document.getElementById('timer').textContent = '0';
    document.getElementById('moves').textContent = '0';
    timer = setInterval(updateTimer, 1000);
  }

  // Оновлення таймера
  function updateTimer() {
    seconds++;
    document.getElementById('timer').textContent = seconds;
  }

  // Відображення гри
  function render() {
    game.innerHTML = '';
    tiles.forEach((text, i) => {
      const div = document.createElement('div');
      div.className = 'tile';
      if (text === '') {
        div.classList.add('empty');
      } else if (badTiles.includes(text)) {
        div.classList.add('bad');
      } else {
        div.classList.add('good');
      }
      div.textContent = text;
      div.addEventListener('click', () => moveTile(i));
      game.appendChild(div);
    });
    checkForSquare();
  }

  // Рух плитки
  function moveTile(index) {
    const emptyIndices = [];
    tiles.forEach((tile, i) => tile === '' && emptyIndices.push(i));
    
    for (const emptyIndex of emptyIndices) {
      const row = Math.floor(index / gridSize);
      const emptyRow = Math.floor(emptyIndex / gridSize);
      
      const validMoves = [
        index - 1,    // ліво
        index + 1,    // право
        index - gridSize, // верх
        index + gridSize  // низ
      ];
      
      if (validMoves.includes(emptyIndex) && 
          (Math.abs(index - emptyIndex) === 1 ? row === emptyRow : true)) {
        [tiles[index], tiles[emptyIndex]] = [tiles[emptyIndex], tiles[index]];
        moves++;
        document.getElementById('moves').textContent = moves;
        render();
        return;
      }
    }
  }

  // Перевірка на квадрат 2x2 з чорних плиток у кутку
  function checkForSquare() {
    const corners = [
      [0, 1, 6, 7],     // Верхній лівий кут
      [4, 5, 10, 11],    // Верхній правий кут
      [24, 25, 30, 31],  // Нижній лівий кут
      [28, 29, 34, 35]   // Нижній правий кут
    ];
    
    for (const corner of corners) {
      if (corner.every(index => badTiles.includes(tiles[index]))) {
        // Знайшли квадрат 2x2 - замінюємо плитки
        corner.forEach(index => {
          const replacement = replacements[Math.floor(Math.random() * replacements.length)];
          tiles[index] = replacement;
        });
        
        // Анімація зміни
        setTimeout(() => {
          render();
          if (!tiles.some(tile => badTiles.includes(tile))) {
            clearInterval(timer);
            alert(`Вітаю, ${playerName}! Ви перемогли за ${seconds} сек і ${moves} ходів!`);
          }
        }, 300);
        return;
      }
    }
  }

  // Перемішування масиву
  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // Обробники подій
  document.getElementById('resetButton').addEventListener('click', () => {
    tiles = shuffle(tiles.filter(tile => tile !== ''));
    while (tiles.length < gridSize * gridSize) tiles.push('');
    resetStats();
    render();
  });

  document.getElementById('newGameButton').addEventListener('click', initGame);
  document.addEventListener('touchstart', function() {}, {passive: true});

  // Початок гри
  initGame();
</script>

</body>
</html>
